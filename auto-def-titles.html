<script>
document.addEventListener('DOMContentLoaded', () => {
  // נסה לחלץ את מספר הפרק (המספר לפני הנקודה הראשונה)
  function chapterNumber() {
    // פרק בדף ספר של Quarto לעתים מסומן על h1 עם data-number
    const h1 = document.querySelector('main h1[data-number]');
    if (h1 && h1.getAttribute('data-number')) {
      return h1.getAttribute('data-number').split('.')[0];
    }
    // אחרת, חפש את המספר הראשון שמופיע ליד כותרת מקוטלגת
    const sec = document.querySelector('.header-section-number');
    if (sec) {
      return sec.textContent.trim().split('.')[0];
    }
    // fallback: אם אין — נניח 1
    return '1';
  }

  const chap = chapterNumber();
  let defCounter = 0;

  document.querySelectorAll('div.definition').forEach(div => {
    // אל תיצור כפילות: אם יש כבר כותרת Quarto, דלג
    if (div.querySelector(':scope > .theorem-title')) return;

    defCounter += 1;
    const title = document.createElement('div');
    title.className = 'theorem-title';
    title.textContent = `הגדרה ${chap}.${defCounter}`;
    // הכנס את הכותרת כילד ראשון של הבלוק
    div.insertBefore(title, div.firstChild);
  });
});
</script>
